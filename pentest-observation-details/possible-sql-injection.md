# Possible SQL Injection

### Vulnerable API:

ROC Detailed Search :  Create Hunt

### Severity:

&#x20;Medium

### Description:

As we saw above how CIN number was interacting with the particular API. Now while testing for SQL Injections special characters gave an interesting error. When  adding single **“single quote”** the page was responding with custom error page, but when it was appended with  two “single quotes” the page was not responding with any error. This signifies there is a SQL injection in this place.

### Steps:

1. Forward the request from the above API to postman , intercept the request in BURP.
2. Move the request to repeater and look at the request headers and parameters.

![Original Request](https://lh6.googleusercontent.com/wdUbIqfyFJ3-g9XzcxL1Zbg6abluJaxNsGukUziZk6fakXpUsIrOwyzgJ34y1I73djrLRVXACgc5xcGP\_N3kSTE0mt\_Xr7yq8285LbFA6nfl1QKCz9RmuBGRjNZDoHvz1pViBKZc)

3\. Adding the payload to check the error page.

![Error After adding 1 single quote](https://lh4.googleusercontent.com/uhfjlrnFweZTvamsFnYpMkoN66XUR3R86X50Y6xVC\_\_d-4phLuCnevZhvkhphvizuH97ldECEln7jMRpXjKRQcgw8qzWQ5qDVMM4\_uVf0BKy9r0v2LG3N2HYp\_xJn6vDO0zwksYC)

As you can see that the custom error message is being displayed.

4\. Now adding double “single quotes”  and checking the response.

![200 ok after adding 2 single quotes](https://lh4.googleusercontent.com/Qr\_o4rUKxnDDLEHF7XC9Ez\_5mgA\_D92LJm87Vhm25hd3UgsXT2JLkeSTWnn5TJY2epOKpzMUHEIz31fhgy8NmSlLlen3RF6EuN4baGz-zPwhveJbXzlIdyToHyzM0kzkBgcsEScg)

As you can see the payload I added was **“cin”:”\<some\_number>’’ “**

5\. After trying lots of SQL commands , I was still not able to get any more information regarding the SQL server, but this error definitely exploitable.

### Impact:

Leak of full Database.

### Solution:

Sanitation of special characters before and after the request has been made.

###
