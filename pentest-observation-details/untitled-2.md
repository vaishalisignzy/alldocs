# External HTTP Interaction

### Vulnerable API:

All

### Severity:

Medium&#x20;

### Description:

When using Aadhaar Identity API, the API is making a call to the pictures of Aadhaar Card uploaded using “File Upload” API to persist.signzy.tech for the photos, hence this might be possible injection point for external websites, as a security standard this particular URL should always be confirmed to use persist.signzy.tech and no other URL, but the API was calling other domains.

### Steps: 

1. Forward the request from POSTMAN to BURP suite and intercept the request in between.
2. Move the request to Repeater and see for yourself that the request parameters are calling [https://persist.signzy.tech](https://persist.signzy.tech) for the images.\


![Burp Request ](https://lh6.googleusercontent.com/y4piNZ94Kdi-uGwTE9zyLR4TLcOYX18b47y4IZ6jP\_jJYTWxydh\_ywUq6wiHiFzWgEengNJLyLzAhpEyH44RewvWaOyTK1YWaKTm\_DopGEvxFQ9\_OOaKwgj4jRaJWq0-Ia31Xd8I)

3\. As you can see that the request has been generated this way, now starting a local web server using ngrok, also saving an image of aadhar card in our web server.\


![Kali Web Server ](https://lh5.googleusercontent.com/N3k0IFt2T8ZpTCLtv\_4svsVAU-KmyOD4zMyxHR26wpoT0f0by3CVJCsH3lXkG20f6pBShkAQJgXdbrhTlt0Ce3JhwzKxL55S9OtQYJoQYXx86IjwYsRcmBVTq4PO2AhR-pX6dOsb)

4\. Now changing the request parameters of the photo link to the above hence new parameters will be like.

```javascript
"images": [
    "https://ec117082.ngrok.io/index.jpeg",
"https://persist.signzy.tech/api/files/753842/download/Sy0JOzh9evtWL311cVirCuMmZU6oqwW1ZVruybHWP5aiksy5vw.png"
  ]
```



5\. Forwarding the request in repeater, you will see that the API is making a call on my local web server.\


![Request and Response ](https://lh3.googleusercontent.com/4FgotftVVq5xo\_glM7YbqSS38rCgZyrnkiCwSuVYpOl-9yvjF3lUM5U3g\_ep\_3l5Sd9G-RHHdYUXt4ZHdIUa-K9hienXfPn8jxPJCs-9jidJuDGOWkRpE58672qKMNzGlgWg3DkF)

![Response From Web Server](https://lh3.googleusercontent.com/Loe2skVwisS0UpcBUEGHDhqytq-UnzqhqEJHROPoVa-tlSBE\_XU27CC5MztfuExNe3hQmEeGq4oIyQDmEFOSJFBk22VAZLhV41hnF2HKbqlujfer5hdpnTnxa7mBPoodtBh93H7w)

6\. As you can see that the API successfully made the call and extracted sample Aadhaar card image from my server.

### Impact:

The API should never be allowed to call other domains as this can lead to sensitive information leak.

### Solution:

Interaction with external HTTP should only be filtered out and possibly used with white listed domains in the domain.
