# Malicious File upload to XSS / HTML Injection / Open Reirect

### Vulnerable API

Persist new: File Upload

### Severity:

High

### Description:

While uploading any .jpeg / .png file on the server one can upload any file on the server by intercepting the file by burp suite and then changing the file content and the extension. Server will not respond with an error.

### Steps:

1. Open the API in POSTMAN , open any .jpeg file from your PC to upload.
2. Intercept the request and look at the parameters for the request.

![File Upload request](https://lh4.googleusercontent.com/SITF-LTMedplPH68PxtJef3RkfLUF4-q4nsziTHKs\_mM8043edFhStWW84cgYHvqNrrSsmEKmKAkqJK1iXGbYgmz6uLcN72M2U3W8s93EDC1ly9PciGQl3D6C66v-bLbNevttG\_O)

3\. As you can see that there is no error while selecting the file from client side. One can Upload any file on the server. Checking the response.\


![200 Ok response](https://lh3.googleusercontent.com/abEBizXJR-KsSSbIvQ2A3XxcMt6wgt7ZXlQVQ-t5Lb4z4LmAYQSUsuynJjIlCS9zTOGrD-795LVa0wS0OrCPvHpbWGjyj8Zo9Sp\_LF\_LdmvIGLmKREsvuTSSoTUMshouEufJSOny)

4\. Now above is the URL where this HTML file is stored and running, hence opening the file on a seperate browser resulted in running the file\


![XSS](https://lh6.googleusercontent.com/tK\_jg9qJZCbSmNjtxslXmmFSf6TqPH2uOZ5mVi9uDNQ7sl-y6v97av9vPhpnchkWtCo9KxCljM2ssznA-TPRzMCZ4d\_I8eZWHyOomfP4R\_e1\_kPndSbGMYuWhlBzps7dD9IUAu0Q)

As you can see that this particular URL is running and can be used to add its own content in it like adding an \<iframe> tag using the clickjacking vulnerability to show that this is also a domain run by signzy.\


![HTML Injection and Exploiting Click jacking ](https://lh3.googleusercontent.com/kMnPwSpq7NxJgFFkW2tnl7aozP-LVALifFFOtoq2icrhtpbg\_SHJvBE7SQPqZaKV3KPZB-szUvFnpasXq9vO0LAwxVaqvkans3J9BIyxlNHZsAMTQLmtEFyzp1HFRfDYWKjoIDRr)

As you can see that this page is exploiting clickjacking vulnerability as well as Malicious file upload.

### Impact:

Can be used as a Phishing URL against other users.

### Solution:

Keeping a Content-Type filter to upload any data and for confirming the same for any image file. Also checking the meta data for the same.\
