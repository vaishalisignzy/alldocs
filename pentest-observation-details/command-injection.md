# Command Injection

### Vulnerable API:

ROC Detailed Search&#x20;

### Severity:

High

### Description:

While testing the above API , the CIN number was being used to fetch details about any organization. Hence by injecting Linux commands in the CIN number, even though it was not reflecting in the response, but network commands of linux environment were running without any hitch, By using  **“ping”**  command to delay the response time , also by using **“netcat”** to put the server in a state of connection to another server only difference here is that the IP used didn’t exists hence putting the server in a state of DOS mode.

### Steps:

1. Use the above API to call for a request using POSTMAN, intercept the request using BURP.
2. Once done move this request to Repeater to play around with the headers and parameters.
3. The request looks something like this

![Original Request](https://lh3.googleusercontent.com/suihLMe2ANDSobcJWxqyYJagTVZjeuKE3Man0WEC5cqeDEDmDQW5mFxl4vqDa0M6ZbK24aZcbyN\_Pmh4Q3Px1LNVA0A6P3APJm4Jjpd4NsdZCEFm5K\_-9kh-DfGAjdIM\_XfQYIXu)

4\. Here the vulnerable Parameter is the **“cin”** number, let’s add a **“ | “** followed by a network command like “**ping -c 21 127.0.0.1”**. Hence the parameter becomes

![Adding network Command ](https://lh3.googleusercontent.com/vi8ghxKk3zPLNM8WfIf-23zwLp00nfwIcUBImrh4\_Hy96N-M\_UFjyeja8Ka9ZcvnUoK0EdWhbG0LYp2LWTpJXt06g\_Jxt2UZEDp8H7BBDjRA36YLeVFu-f7pIyBiYghg9-8dNkDD)

5\. Forward the request and the server would respond after 21 sec as “-c” being the number of packets send.\


![Response after 21 secs](https://lh3.googleusercontent.com/MTPo0p3EFsbkBZ09gvp73C6luHEl1nDsOyNJqmmLj1I4TlJ4z8GjbzIExegUrqIzWF1EWHEJZ0OVEjmdApgRlGSLw9qN6OB84LHyeXaLchqwq7wxrN7\_G2M\_kToN7Y0kUDcXI4uR)

As you can see at the bottom right corner the response from the server was after 20 sec.

6\. Again to verify the same let’s add “**ping -c 30 127.0.0.1**”. As the command.

![Response After 30 sec](https://lh5.googleusercontent.com/Af57PeL7grKSwx9Ek2ZliFiRAfOM-Fer-ChIYw6eQ9DGNISD50uqCUamsNc\_ctz6NysbVvVfJ1LW\_yPqjCdcTQhdh1PTE9185-bn0IlLtCIVobGmSGDEBt\_flalZoJaAMrgPGY\_j)

Again checking the same bottom right corner for the server time response. It returns 29.170 ms.

7\. Now checking the following command, “**nc 192.168.1.32 12345**” this will result in server not responding at all until we cancel the request. Which confirms the case that the server is trying to connect to above specified IP using this command and can’t respond until the connection is actually cancelled by the foreign host.\


![Netcat command interaction](https://lh5.googleusercontent.com/lzpByGTkxbcQzK-GS25ysKREG27Dias4G3i8ZxRT3x4r3HN9tExvVUJy5VexOmYqFC9NcjFCeolW7-xBzJqXL37XCJtqgFjrGm1V3sM8ciELT904ICeUnKfsncu699Fq4nzzLUvW)

As you can see that the server is not responding at all until you cancel the request.

8\. What you can see here is that even though the normal file system commands can be used here, but we can still use network commands to put a server on a “Hold up” state.

### Impact:

Command Injection is one of the most dangerous vulnerability as it can lead to many possibilities for the hacker, like DOS attack, DNS lookup , Reverse Connection etc.

### **Solution:**

Blacklisting special characters like :

* |
* &
* ;
* \`
* ;
* \~
