# Server Side Request Forgery

### Vulnerable API:

Aadhaar Identities

### Severity:

High

### Description:

As mentioned above that this API is actually calling external domains to connect. Hence I gave the domain to localhost so that the API calls the localhost to connect. As expected the API returned a 500 Internal Server Error whose resulted in me running a port scan on the server.

### Steps:

1. Forward the request from POSTMAN to BURP and intercept the request.
2. Forward this request to the repeater and change the Request ‘IMAGES’ parameter to something like.

![Original Request ](https://lh3.googleusercontent.com/aLzH\_hgeoY9Bim3p5pEL1cjkMRSRQEcb-BtgX5Wx1qHmMBJde-GiPedvIOIaamlqryYfbNOUk9375UQSaBwu0ZjF2gZDId-fITp6zfowHj8MbHCqGfTtAAhnxgyrEi2IqJHThRif)

&#x20;3\. Now change any link in the given parameter to [https://localhost](https://localhost):22  or [https://127.0.0.1:22](https://127.0.0.1:22) , now forward the request, you will be prompted by an internal 500 server error saying that NOT FOUND, \


4\. Now again changing to a random port like 1234, you will be prompted with **ECONNREFUSED**, signifying that this port is not open and connection is refused.\


![SSRF Response](https://lh4.googleusercontent.com/hBpttN5QZSHnoZIEh6T8Sy49UxK2Khu\_9FwlWK6G1WhbPij3dlP\_mhUZm9KdSylQG63DOXBcwnhfisZM4jzknF8qFwZVKU8oEXznkOBDfj2s1XToeJ9R\_5XOwT00WDifa4R81vnD)

5\. Now changing the parameter to [https://localhost](https://localhost) or  [https://127.0.0.1](https://127.0.0.1) and let’s see the response.

![CA Certificate from SSRF](https://lh5.googleusercontent.com/UZN25iN22jIbBlPzNjwzJtB51PY-6bWjYzFxw5yFgoBz5fRonk97E8HXsGyakntzvQ3Y8C8wYfRBhmVQzPKm98hhRRqJZ8\_QcgHwZ3op5fp8ws1h9yB8Kcgz0w4C8YplsAgfLwQX)

&#x20;6\. As you can see by putting in [https://localhost](https://localhost) we can see the full certificate issued to \*.signzy.tech

### Impact:

Allowing localhost is always vulnerable as it can Lead to SSRF i.e Server Side Request Forgery. Which can be used to get either RCE, or port scanning of the web server.

### Solution:

Again filtering out HTTP interaction, and blacklisting the following,

* localhost
* 127.0.0.1
* http://0177.1/
* http://0x7f1.1/
* http://127.000.000.1
* https://520968996
* http://\[::1]&#x20;
* http://\[::]

### &#x20;
